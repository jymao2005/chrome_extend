var app=angular.module("app",["ui.router"]);app.controller("homeCtr",function(t,n,o){t.username=sessionStorage.getItem("username"),t.exit=function(){n.out(),sessionStorage.removeItem("username")},t.updatePwd=function(){}}),app.controller("navCtr",function(t,n){t.nav=[{sref:"home",on:!0,class:"fa-user",content:"用户管理"},{sref:"home.classifyMan",on:!1,class:"fa-tasks",content:"分类管理"}],n.$$url.indexOf("/classifyMan")==-1?(t.nav[0].on=!0,t.nav[1].on=!1):(t.nav[0].on=!1,t.nav[1].on=!0),t.setOn=function(n){if(1!=t.nav[n].on){for(var o=0;o<t.nav.length;o++)t.nav[o].on=!1;t.nav[n].on=!0}}}),app.controller("loginCtr",function(t,n,o){t.success=!0,t.submit=function(){t.data={name:t.username,password:t.password},o.in(t.data).success(function(o){"login ok"==o.msg?(sessionStorage.setItem("username",t.username),t.success=!0,n.go("home")):t.success=!1})}}),app.controller("userManCtr",function(t,n){t.user=[],t.getUser=function(){n.get().success(function(n){t.user=n})},t.getUser(),t.del=function(o){var e=confirm("是否删除该用户");if(e){var r={name:t.user[o].name};n.del(r)}},t.add=function(){var o=prompt("输入用户名",""),e=confirm("是否为管理员"),r={name:o};e&&(r.role="admin"),n.add(r),t.getUser()}}),app.config(function(t,n){n.otherwise("/home"),t.state("home",{url:"/home",views:{"":{templateUrl:"dist/tpls/home.html",controller:"homeCtr"},"nav@home":{templateUrl:"dist/tpls/nav.html",controller:"navCtr"},"content@home":{templateUrl:"dist/tpls/userMan.html",controller:"userManCtr"}}}).state("home.classifyMan",{url:"/classifyMan",views:{"content@home":{templateUrl:"dist/tpls/classifyMan.html",controller:function(t){}}}}).state("login",{url:"/login",templateUrl:"dist/tpls/login.html",controller:"loginCtr"})}),app.factory("log",function(t){return{in:function(n){return t({method:"post",url:"http://www.jymao.com/ds/login",data:n})},out:function(){t({method:"post",url:"http://www.jymao.com/ds/logout"})},vail:function(){return t({method:"get",url:"http://www.jymao.com/ds/has-login"})}}}),app.factory("user",function(t){return{get:function(){return t({method:"get",url:"http://www.jymao.com/ds/g/User"})},del:function(n){return t({method:"post",url:"http://www.jymao.com/ds/user",data:n})},add:function(n){return t({method:"post",url:"http://www.jymao.com/ds/user",data:n})}}}),app.factory("classify",function(t){var n="http://www.jymao.com/ds/g/Category";return function(o){return t({method:"post",url:n,data:o})}});